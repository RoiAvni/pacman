## 🎮 פרוייקט סיום DevOps – Pacman על AWS

🧾 תאור כללי
הפרויקט מציג תהליך DevOps מלא – החל משכפול קוד המקור של משחק Pacman מ־GitHub, דרך הקמת תשתית ענן ב־AWS באמצעות Terraform, ועד לפריסה חיה של המשחק על אשכול Kubernetes מנוהל (EKS).
המערכת נבנתה כולה מקוד, בגישת Infrastructure as Code, ומופעלת באמצעות תהליך CI/CD אוטומטי מבוסס GitHub Actions.
המטרה: להפוך כל שינוי בקוד, בין אם בתשתית או באפליקציה, לעדכון חי בענן – בלחיצת git push אחת בלבד.

---

### 🛠️ טכנולוגיות ושירותים עיקריים

1. **AWS EKS** – קוברנטיס מנוהל להרצת קונטיינרים בסביבת ענן  
2. **EC2 Auto Scaling Group** – להרצת 2 נודים מסוג `t3.medium`, עם ניהול משאבים אוטומטי  
3. **Elastic Load Balancer (ELB)** – חשיפה חיצונית של המשחק לציבור דרך כתובת IP קבועה  
4. **Node Group** – קבוצה מנוהלת של נודים שמריצים את הקונטיינרים באשכול  
5. **Terraform** – להקמת תשתיות באופן אוטומטי ומבוסס קוד (IaC)  
6. **S3 + DynamoDB** – לניהול state של Terraform ולנעילה במקביליות  
7. **GitHub Actions** – להרצת תהליך CI/CD אוטומטי על כל שינוי בענף `main`  
8. **kubectl** – לפריסה, ניהול ובדיקת משאבים בתוך ה־Kubernetes Cluster



---

### ⚙️ שלבי הפרויקט

1. **שכפול קוד המשחק** מהמאגר GitHub של הפרויקט המקורי והעלאתו לריפו אישי  
2. **יצירת קבצי Terraform** להקמת EKS, Node Group, Networking ו־IAM Roles  
3. **שימוש בקובץ `backend.tf`** לניהול state בענן בעזרת S3 + DynamoDB  
4. **הרצת `terraform apply`** מתוך GitHub Actions להקמה בפועל של המשאבים בענן  
5. **פריסת הקבצים הקוברנטיים (YAML)** – יצירת קובצי `Deployment` ו־`Service` מסוג LoadBalancer  
6. **הגדרה ידנית של `aws-auth ConfigMap`** עקב שגיאות ב־Terraform Provider  
7. **הוספת תהליך CI/CD אוטומטי עם GitHub Actions**:  
   * שלב 1: `terraform apply` אוטומטי על כל שינוי בתשתית  
   * שלב 2: `kubectl apply` אוטומטי על קובצי YAML  
8. **בדיקות סופיות** – ווידוא שיש 2 נודים, 2 פודים פעילים, והאתר מגיב דרך Load Balancer  
9. **שיפור קובצי YAML** – שינוי `replicas` ל־3 ולאחר מכן חזרה ל־2, דרך GitHub בלבד (ללא מגע ידני)


---

### 🔁 קונסיסטנטיות מלאה ב־CI/CD

המערכת פועלת כיום כך שכל שינוי שמבוצע בענף `main` של GitHub מוביל אוטומטית ל־:

- ⚙️ עדכון התשתיות בענן באמצעות Terraform  
- 🚀 עדכון השירותים והרפליקות בקוברנטיס באמצעות kubectl

השינויים נכנסים לפעולה באופן אוטומטי, ללא צורך בהרצה ידנית, וממחישים תהליך CI/CD מלא – מהקוד ועד לענן.
  

---

### 🧠 אתגרים ופתרונות

- שימוש ב־Provider של קוברנטיס מתוך Terraform גרם לשגיאות הרשאות מול אשכול ה־EKS  
  ➜ הפתרון: מעבר להגדרה ידנית של ConfigMap מסוג `aws-auth` בעזרת `kubectl`

- הסנכרון הראשוני בין GitHub ל־Terraform דרש יצירת secrets והפרדת ערכים לקבצים מתאימים  
  ➜ פתרון: שימוש בקבצים `terraform.tfvars` ו־`backend.tf` עם ערכים רגישים בנפרד

- קובץ ה־Deployment דרש תיקון בערך `replicas`, והריצה נבדקה אוטומטית דרך GitHub Actions  
  ➜ הפתרון: עדכון הערך ישירות ב־GitHub, והפעלת `kubectl apply` כחלק מה־CI/CD

- למרות שהוגדרו 2 נודים בקובצי Terraform, לעיתים ה־Node Group הפעיל רק נוד 1  
  ➜ הפתרון: בוצע תיקון ידני דרך הקונסולה של AWS – עדכון ההגדרות ל־minSize=2 ושמירה

 

---

<p dir="rtl">

## 🖼️ צילומי מסך

להלן צילומי מסך מהשלבים השונים שבוצעו במהלך הפרויקט:

| 🆔 מספר | 📄 תיאור                                                                                     |
|--------|-----------------------------------------------------------------------------------------------|
| 1      | **Amazon EKS** ב־ קלאסטר פעיל                                                               |
| 2      | באשכול פעילים שני נודים                                                                     |
| 3      | **Node Group** כחלק מ־ שהוקמו **EC2** מכונות                                               |
| 4      | **Load Balancer** דרך למשחק ציבורית חשיפה                                                  |
| 5      | `kubectl get nodes` של הפקודה פלט — נודים שני                                              |
| 6      | `kubectl get pods` של הפקודה פלט — פודים פעילים שני                                        |
| 7      | `kubectl get service` של הפקודה פלט — **LoadBalancer** מסוג שירות                         |
| 8      | ל־2 חזרה ו־3 ל־ מ־ `replicas` ערך שינוי — בדיקה                                            |
| 9      | **Terraform** עבור **GitHub Action** הרצת                                                  |
| 10     | **kubectl** עבור **GitHub Action** הרצת                                                    |
| 11     | `kubectl` בעזרת `aws-auth.yaml` קובץ פריסת                                                 |
| 12     | **LoadBalancer** דרך בענן **Pac-Man** משחק הרצת                                            |
| 13     | **VSCode** ב־ הפרויקט של והתיקיות הקבצים מבנה                                              |

> 📁 **הערה:** כל קבצי התמונות שמורים בתיקייה `screenshots/`


---

### 🌐 קישור לאתר החי (Load Balancer)

af81060c75fd2433dbbefedebbf259d7-2021084926.eu-west-3.elb.amazonaws.com

---

<p dir="rtl">

## 🧩 מבנה תיקיות

```
📁 root/
├── 📁 .github/workflows/         # קבצי GitHub Actions (CI/CD)
│   ├── 📄 deploy-kubectl.yml
│   └── 📄 terraform.yml
├── 📁 terraform/                # קוד תשתית AWS באמצעות Terraform
│   ├── 📄 main.tf
│   ├── 📄 variables.tf
│   ├── 📄 outputs.tf
│   ├── 📄 backend.tf
│   └── 📄 terraform.tfvars
├── 📁 k8s/                      # קבצי YAML לפריסת Pac-Man על EKS
│   ├── 📄 aws-auth.yaml
│   ├── 📄 pacman-roiavni-deployment.yaml
│   └── 📄 pacman-roiavni-service.yaml
├── 📁 screenshots/             # 📸 צילומי מסך של כל שלבי הפרויקט (01–13)
├── 📁 public/                  # קוד המקור של המשחק (HTML, CSS, JS, תמונות, אודיו)
├── 📁 docker/dev/              # סקריפטים ודוקר לפיתוח מקומי
├── 📁 routes/                  # נתיבי backend באפליקציה
├── 📁 views/                   # תבניות Jade להצגת דפי HTML
├── 📁 lib/                     # קבצי תצורה למסד נתונים
├── 📄 app.js                   # קובץ ראשי להרצת השרת
├── 📄 server.js                # קובץ שרת Node.js
├── 📄 Dockerfile               # לבניית Docker image של האפליקציה
└── 📄 README.md                # תיעוד מלא של הפרויקט
```

> 📝 **הערה**: בתיקיית `public/` נמצאים כל המשאבים הסטטיים להפעלת המשחק – כולל HTML, CSS, JavaScript, תמונות וצלילים.

</p>


---

### 📦 שלב עתידי – Docker + ECR עבור Node.js

האפליקציה בנויה כ־Node.js מלא, כולל server.js ו־app.js, עם Dockerfile שמבצע התקנה והרצה.
ניתן לבנות Docker Image, לדחוף אותו ל־Amazon ECR
ולעדכן את ה־Deployment של Kubernetes לשימוש בתמונה הפרטית.

* מתאים לארגונים שרוצים שליטה בקוד ובגרסאות  
* מאפשר להרחיב בקלות את הלוגיקה בעתיד  
* מדגים CI/CD מלא – גם על קוד אפליקציה, לא רק תשתית  

💡 לא נדרש בפרויקט, אך רלוונטי מאוד בתעשייה  

---

### 🧠 מה למדתי

* איך בונים תשתיות ב־AWS בצורה אוטומטית ומודולרית (Terraform)  
* איך מחברים בין קוד, תשתית ופריסה (CI/CD מלא)  
* איך מתמודדים עם באגים כמו הרשאות EKS או פודים שנופלים  
* איך בודקים כל שינוי בגיטהאב ויודעים שהוא מגיע לענן באמת  

---

### ✅ מצב סיום

* [x] הקלאסטר פעיל  
* [x] המשחק פועל  
* [x] כל שינוי ב־GitHub ➜ מגיע לענן  
* [x] מוכנות מלאה להגשה  


